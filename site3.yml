---
  - name: Common Configuration
    hosts: all
    roles:
      - Juniper.junos
      - common
    connection: local
    gather_facts: no

    pre_tasks:
    - name: Delete log file structure
      file:
        path: "{{ log_dir }}/log_common"
        state: absent
      run_once: true

    - name: Create log file structure
      file:
        path: "{{ log_dir }}/log_common"
        state: directory
        mode: 0755
      run_once: true

    - name: Delete Build file structure
      file:
        path: "{{ build_dir }}"
        state: absent
      run_once: true

    - name: Create Build file structure
      file:
        path: "{{ build_dir }}"
        state: directory
        mode: 0755
      run_once: true

  - name: dc1 configuration
    hosts: dc1
    roles:
      - dc1
    connection: local
    gather_facts: no

  - name: routers configuration
    hosts: routers
    roles:
      - routers
    connection: local
    gather_facts: no

  - name: logical sysyem configuration
    hosts: vmx-1 vmx-2
    roles:
      - logical-sys
    connection: local
    gather_facts: no

  - name: mpls configuration
    hosts:  vmx-1 vmx-2
    roles:
      - mpls
    connection: local
    gather_facts: no

  - name: l3vpn bgp configuration
    hosts:  vmx-1 vmx-2
    roles:
      - l3vpn-bgp
    connection: local
    gather_facts: no

#  - name: l3vpn ospf configuration
#    hosts:  vmx-1 vmx-2
#    roles:
#      - l3vpn-ospf
#    connection: local
#    gather_facts: no

#  - name: l3vpn static configuration
#    hosts:  vmx-1 vmx-2
#    roles:
#      - l3vpn-static
#    connection: local
#    gather_facts: no
